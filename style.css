const db = firebase.database();
let userRole = "user"; // по умолчанию

function setUserRole(role) {
  userRole = role;
  alert("Вы вошли как: " + (role === "admin" ? "Админ" : "Пользователь"));
}

// Отправка сообщения
function sendMessage() {
  const input = document.getElementById("messageInput");
  const text = input.value.trim();
  if (text === "") return;

  const message = {
    sender: userRole,
    text: text,
    timestamp: Date.now()
  };

  db.ref("messages").push(message);
  input.value = "";
}

// Получение сообщений
db.ref("messages").on("child_added", (snapshot) => {
  const msg = snapshot.val();
  displayMessage(msg);
});

function displayMessage(msg) {
  const container = document.getElementById("chatMessages");
  const div = document.createElement("div");
  div.classList.add("message", msg.sender);
  div.textContent = (msg.sender === "admin" ? "Админ: " : "Пользователь: ") + msg.text;
  container.appendChild(div);
  container.scrollTop = container.scrollHeight;
}
